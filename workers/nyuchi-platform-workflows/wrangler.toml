# Nyuchi Platform Workflows Worker
# Durable multi-step workflows using Cloudflare Workflows

name = "nyuchi-platform-workflows"
main = "src/index.ts"
compatibility_date = "2024-12-01"
compatibility_flags = ["nodejs_compat"]
account_id = "125a2dfbc21f76a25c980609609e8218"

# ============================================
# Workflows Configuration
# ============================================
[[workflows]]
name = "content-review-workflow"
binding = "CONTENT_REVIEW"
class_name = "ContentReviewWorkflow"

[[workflows]]
name = "listing-review-workflow"
binding = "LISTING_REVIEW"
class_name = "ListingReviewWorkflow"

[[workflows]]
name = "verification-workflow"
binding = "VERIFICATION"
class_name = "VerificationWorkflow"

[[workflows]]
name = "expert-application-workflow"
binding = "EXPERT_APPLICATION"
class_name = "ExpertApplicationWorkflow"

[[workflows]]
name = "onboarding-workflow"
binding = "ONBOARDING"
class_name = "OnboardingWorkflow"

# ============================================
# Production Environment
# ============================================
[env.production]
name = "nyuchi-platform-workflows"

[env.production.vars]
ENVIRONMENT = "production"

# Queue producers
[[env.production.queues.producers]]
queue = "nyuchi-jobs-queue"
binding = "JOBS_QUEUE"

[[env.production.queues.producers]]
queue = "nyuchi-notifications-queue"
binding = "NOTIFICATIONS_QUEUE"

# Observability
[env.production.observability]
[env.production.observability.logs]
enabled = true
head_sampling_rate = 1
invocation_logs = true

# ============================================
# Development defaults
# ============================================
[vars]
ENVIRONMENT = "development"

[[queues.producers]]
queue = "nyuchi-jobs-queue"
binding = "JOBS_QUEUE"

[[queues.producers]]
queue = "nyuchi-notifications-queue"
binding = "NOTIFICATIONS_QUEUE"
